<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quran Kareem (Ar)</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Amiri&family=Cairo&family=El+Messiri&family=Harmattan&family=Lateef&family=Scheherazade+New&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Amiri', serif;
            transition: background 0.3s, color 0.3s;
        }
        .dark-mode {
            background-color: #121212;
            color: #ffffff;
        }
        .settings-container, .header, .verse {
            text-align: center;
            margin: 10px;
        }
        .settings-item {
            display: inline-block;
            cursor: pointer;
            padding: 10px;
            font-size: 20px;
        }
        .verse {
            border-bottom: 1px solid #ddd;
            padding: 10px;
        }
        .verse.selected {
            background: lightyellow;
        }
        .bookmark-btn, .audio-btn, .search-btn {
            cursor: pointer;
            padding: 5px;
            margin: 5px;
            font-size: 16px;
        }
        .search-box {
            margin: 10px;
            padding: 5px;
            font-size: 16px;
            width: 80%;
        }
    </style>
</head>
<body>

<div class="settings-container">
    <div class="settings-item" onclick="toggleTheme()"><i class="fas fa-adjust"></i></div>
    <div class="settings-item" onclick="changeTextSize(1)"><i class="fas fa-plus"></i></div>
    <div class="settings-item" onclick="changeTextSize(-1)"><i class="fas fa-minus"></i></div>
    <div class="settings-item" onclick="toggleFont()"><i class="fas fa-font"></i></div>
</div>

<input type="text" class="search-box" placeholder="Search Surah or Verse..." oninput="searchVerse(this.value)">
<div class="header">
    <i class="fas fa-arrow-left" onclick="navigateSurah(-1)"></i>
    <span id="surah-heading"></span>
    <i class="fas fa-arrow-right" onclick="navigateSurah(1)"></i>
</div>

<div id="content"></div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        if (localStorage.getItem('darkMode') === 'true') document.body.classList.add('dark-mode');
        document.body.style.fontSize = localStorage.getItem('textSize') + 'px';
        fetchSurah(getQueryParam('index') || 1);
    });

    function getQueryParam(param) {
        return new URLSearchParams(window.location.search).get(param);
    }

    async function fetchSurah(index) {
        const response = await fetch(`https://raw.githubusercontent.com/itzfew/Quran-Online/main/source/surah/surah_${index}.json`);
        const data = await response.json();
        displaySurah(data);
    }

    function displaySurah(data) {
        document.getElementById('surah-heading').innerText = data.name;
        const content = document.getElementById('content');
        content.innerHTML = '';
        
        Object.keys(data.verse).forEach(i => {
            const verseDiv = document.createElement('div');
            verseDiv.classList.add('verse');
            verseDiv.innerHTML = `
                <div class="arabic-text">${data.verse[i]} <span class="verse-number">${i}</span></div>
                <button class="audio-btn" onclick="playAudio(${i})">üîä</button>
                <button class="bookmark-btn" onclick="bookmarkVerse(${i})">‚≠ê</button>
            `;
            content.appendChild(verseDiv);
        });
    }

    function toggleTheme() {
        document.body.classList.toggle('dark-mode');
        localStorage.setItem('darkMode', document.body.classList.contains('dark-mode'));
    }

    function changeTextSize(increment) {
        let newSize = parseInt(getComputedStyle(document.body).fontSize) + increment;
        document.body.style.fontSize = newSize + 'px';
        localStorage.setItem('textSize', newSize);
    }

    function toggleFont() {
        const fonts = ['Amiri', 'Cairo', 'El Messiri', 'Harmattan', 'Lateef', 'Scheherazade New'];
        const currentFont = document.body.style.fontFamily;
        const nextFont = fonts[(fonts.indexOf(currentFont) + 1) % fonts.length] || fonts[0];
        document.body.style.fontFamily = nextFont;
    }

    function playAudio(verseId) {
        alert(`Playing audio for verse ${verseId}`);
    }

    function bookmarkVerse(verseId) {
        alert(`Bookmarked verse ${verseId}`);
    }

    function searchVerse(query) {
        const verses = document.querySelectorAll('.verse');
        verses.forEach(v => v.style.display = v.innerText.includes(query) ? 'block' : 'none');
    }

    function navigateSurah(direction) {
        let index = parseInt(getQueryParam('index') || 1) + direction;
        if (index < 1) index = 1;
        if (index > 114) index = 114;
        window.location.href = `?index=${index}`;
    }
</script>

</body>
</html>
